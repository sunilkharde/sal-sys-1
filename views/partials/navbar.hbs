{{!-- views/partials/navbar.hbs - OPTIMIZED --}}
<nav class="navbar navbar-expand-lg navbar-dark sticky-top">
    <div class="container-fluid">
        <a class="navbar-brand" href="/">
            <div class="navbar-image-wrapper">
                <img id="imgLogo" src="/images/Saleswift_logo.webp" alt="Malpani Group Logo"
                    class="d-inline-block align-top img-fluid">
                {{!-- <span class="navbar-brand-text ms-2 d-none d-md-inline">Malpani Group</span> --}}
            </div>
        </a>

        <button class="navbar-toggler navbar-toggler-custom" type="button" data-bs-toggle="collapse"
            data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                {{!-- Home Link - Show for all logged-in users --}}
                {{#if user}}
                <li class="nav-item">
                    <a class="nav-link {{#isEqual activePage '/'}}active{{/isEqual}}" href="/">
                        <i class="bi bi-house-door me-1"></i>Home
                    </a>
                </li>
                {{/if}}

                {{!-- User Area - Admin/Read/Dealer --}}
                {{#isEqual user.user_role "Admin" "Read"}}
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown1" role="button"
                        data-bs-toggle="dropdown" aria-expanded="false">
                        <i class="bi bi-people me-1"></i>User Area
                    </a>
                    <ul class="dropdown-menu" aria-labelledby="navbarDropdown1">
                        <li><a class="dropdown-item" href="/auth/register">
                                <i class="bi bi-person-plus me-2"></i>Register
                            </a></li>
                        <li><a class="dropdown-item" href="/auth/reset-password">
                                <i class="bi bi-key me-2"></i>Reset Password
                            </a></li>
                        <li>
                            <hr class="dropdown-divider">
                        </li>
                        <li><a class="dropdown-item" href="#">
                                <i class="bi bi-person-lines-fill me-2"></i>Users Master
                            </a></li>
                        <li><a class="dropdown-item" href="/emp/view">
                                <i class="bi bi-person-badge me-2"></i>Employees
                            </a></li>
                    </ul>
                </li>
                {{/isEqual}}

                {{!-- Masters - Admin/Read/Support --}}
                {{#isEqual user.user_role "Admin" "Read" "Support"}}
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown2" role="button"
                        data-bs-toggle="dropdown" aria-expanded="false">
                        <i class="bi bi-grid-3x3-gap me-1"></i>Masters
                    </a>
                    <ul class="dropdown-menu" aria-labelledby="navbarDropdown2">
                        <li><a class="dropdown-item" href="/product/view">
                                <i class="bi bi-box-seam me-2"></i>Products
                            </a></li>
                        <li><a class="dropdown-item" href="/customer/view">
                                <i class="bi bi-shop me-2"></i>Dealers
                            </a></li>
                        <li><a class="dropdown-item" href="/cust-detail/view">
                                <i class="bi bi-shop-window me-2"></i>Sub Dealer
                            </a></li>
                        <li><a class="dropdown-item" href="/customer/benchmark">
                                <i class="bi bi-graph-up me-2"></i>Dealer Benchmark
                            </a></li>
                        <li>
                            <hr class="dropdown-divider">
                        </li>
                        <li><a class="dropdown-item" href="/custTarget/view">
                                <i class="bi bi-bullseye me-2"></i>Targets
                            </a></li>
                        <li><a class="dropdown-item" href="/custTarget/upload">
                                <i class="bi bi-upload me-2"></i>Import Targets
                            </a></li>
                        <li><a class="dropdown-item" href="/custTarget/target-report">
                                <i class="bi bi-clipboard-data me-2"></i>Targets Report
                            </a></li>
                        <li>
                            <hr class="dropdown-divider">
                        </li>
                        <li><a class="dropdown-item" href="/circular/view">
                                <i class="bi bi-file-text me-2"></i>Van Circular
                            </a></li>
                        {{#isEqual user.user_role "Admin"}}
                        <li>
                            <hr class="dropdown-divider">
                        </li>
                        <li><a class="dropdown-item" href="/sap-data/import">
                                <i class="bi bi-database-add me-2"></i>Import SAP Data
                            </a></li>
                        <li><a class="dropdown-item" href="/sap-group/view-group">
                                <i class="bi bi-collection me-2"></i>SAP Groups
                            </a></li>
                        <li><a class="dropdown-item" href="/customer/grouping">
                                <i class="bi bi-diagram-3 me-2"></i>Customers Groups
                            </a></li>
                        {{/isEqual}}
                    </ul>
                </li>
                {{/isEqual}}

                {{!-- Dealer Area - Admin/Read/Dealer --}}
                {{#isEqual user.user_role "Admin" "Read" "Dealer"}}
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown3" role="button"
                        data-bs-toggle="dropdown" aria-expanded="false">
                        <i class="bi bi-building me-1"></i>Dealer Area
                    </a>
                    <ul class="dropdown-menu" aria-labelledby="navbarDropdown3">
                        <li><a class="dropdown-item" href="/po/view">
                                <i class="bi bi-cart-check me-2"></i>Purchase Order
                            </a></li>
                        <li><a class="dropdown-item" href="/dealerPay/view">
                                <i class="bi bi-currency-rupee me-2"></i>Dealer Payment
                            </a></li>
                        <li><a class="dropdown-item" href="/dealerPay/view-bal">
                                <i class="bi bi-wallet2 me-2"></i>Dealer Balance
                            </a></li>
                        <li><a class="dropdown-item" href="/custTarget/view-stock">
                                <i class="bi bi-boxes me-2"></i>Dealer Stock
                            </a></li>
                        <li><a class="dropdown-item" href="/custTarget/view-sale">
                                <i class="bi bi-graph-up-arrow me-2"></i>Dealer Sale
                            </a></li>
                    </ul>
                </li>
                {{/isEqual}}

                {{!-- Sales Zone - Admin/Read/Employee/Account --}}
                {{#isEqual user.user_role "Admin" "Read" "Employee" "Account"}}
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownSales" role="button"
                        data-bs-toggle="dropdown" aria-expanded="false">
                        <i class="bi bi-map me-1"></i>Sales Zone
                    </a>
                    <ul class="dropdown-menu" aria-labelledby="navbarDropdownSales">
                        {{#isEqual user.user_role "Admin" "Read" "Employee"}}
                        <li><a class="dropdown-item" href="/dsrTp/view-pm">
                                <i class="bi bi-calendar-check me-2"></i>Open Month Plan
                            </a></li>
                        <li>
                            <hr class="dropdown-divider">
                        </li>
                        <li><a class="dropdown-item" href="/dsr/view-pm">
                                <i class="bi bi-pencil-square me-2"></i>Work Entry
                            </a></li>
                        <li><a class="dropdown-item" href="/dsr/post-pm">
                                <i class="bi bi-send-check me-2"></i>Posting
                            </a></li>
                        <li><a class="dropdown-item" href="/dsr/report">
                                <i class="bi bi-file-bar-graph me-2"></i>Work Report
                            </a></li>
                        <li><a class="dropdown-item" href="/dsr/report-loc">
                                <i class="bi bi-geo-alt me-2"></i>Locate Team
                            </a></li>
                        <li><a class="dropdown-item" href="/dsr/report-loc2">
                                <i class="bi bi-map me-2"></i>Route Map
                            </a></li>
                        <li>
                            <hr class="dropdown-divider">
                        </li>
                        <li><a class="dropdown-item" href="/customer/view-info">
                                <i class="bi bi-info-circle me-2"></i>Dealer Info
                            </a></li>
                        <li><a class="dropdown-item" href="/custTarget/view-stock">
                                <i class="bi bi-box-seam me-2"></i>Dealer Stock
                            </a></li>
                        <li><a class="dropdown-item" href="/custTarget/view-sale">
                                <i class="bi bi-graph-up me-2"></i>Dealer Sale
                            </a></li>
                        <li><a class="dropdown-item" href="/vanclaim/view">
                                <i class="bi bi-receipt me-2"></i>Van Claim
                            </a></li>
                        <li>
                            <hr class="dropdown-divider">
                        </li>
                        <li><a class="dropdown-item" href="/consumer/view">
                                <i class="bi bi-person me-2"></i>Consumers
                            </a></li>
                        <li><a class="dropdown-item" href="/shop/list">
                                <i class="bi bi-display me-2"></i>Pan Shop Display
                            </a></li>
                        {{/isEqual}}
                        {{#isEqual user.user_role "Admin" "Read" "Account"}}
                        <li>
                            <hr class="dropdown-divider">
                        </li>
                        <li><a class="dropdown-item" href="/dsrAc/view">
                                <i class="bi bi-cash-coin me-2"></i>Expenses Posting
                            </a></li>
                        {{/isEqual}}
                    </ul>
                </li>
                {{/isEqual}}

                {{!-- Reports - Admin/Read/Support/Audit/Account/Bank --}}
                {{#isEqual user.user_role "Admin" "Read" "Support" "Audit" "Account" "Bank"}}
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown4" role="button"
                        data-bs-toggle="dropdown" aria-expanded="false">
                        <i class="bi bi-bar-chart me-1"></i>Reports
                    </a>
                    <ul class="dropdown-menu dropdown-menu-start" aria-labelledby="navbarDropdown4">
                        {{#isEqual user.user_role "Admin" "Read" "Support" "Audit" "Bank"}}
                        <li><a class="dropdown-item" href="/dealerPay/view">
                                <i class="bi bi-currency-rupee me-2"></i>Dealer Payment
                            </a></li>
                        {{/isEqual}}
                        {{#isEqual user.user_role "Admin" "Read" "Support" "Audit" "Account"}}
                        <li><a class="dropdown-item" href="/dsr/report">
                                <i class="bi bi-receipt me-2"></i>Expenses
                            </a></li>
                        <li><a class="dropdown-item" href="/dsrAc/summary">
                                <i class="bi bi-pie-chart me-2"></i>Expenses Summary
                            </a></li>
                        <li><a class="dropdown-item" href="/dsr/report-atten">
                                <i class="bi bi-calendar-event me-2"></i>Attendance
                            </a></li>
                        <li><a class="dropdown-item" href="/dsr/report-loc">
                                <i class="bi bi-geo-alt me-2"></i>Locate Team
                            </a></li>
                        <li><a class="dropdown-item" href="/dsr/report-loc2">
                                <i class="bi bi-map me-2"></i>Route Map
                            </a></li>
                        <li><a class="dropdown-item" href="/dsr/report-area">
                                <i class="bi bi-bounding-box me-2"></i>Area Coverage
                            </a></li>
                        <li><a class="dropdown-item" href="/dsr/report-loc-emp">
                                <i class="bi bi-person-badge me-2"></i>Employee Location
                            </a></li>
                        <li><a class="dropdown-item" href="/customer/report">
                                <i class="bi bi-building me-2"></i>Dealer Info
                            </a></li>
                        {{/isEqual}}
                    </ul>
                </li>
                {{/isEqual}}
            </ul>

            {{!-- Profile Section --}}
            <div class="nav-item dropdown ms-0 ms-lg-2 profile-dropdown-container">
                <a class="nav-link dropdown-toggle d-flex align-items-center py-2" href="#" id="navbarDropdownProfile"
                    role="button" data-bs-toggle="dropdown" aria-expanded="false">
                    <span class="navbar-text2 {{#if user.username}}text-warning{{else}}text-light{{/if}}">
                        {{#if user.username}}
                        <i class="bi bi-person-circle me-1"></i>Hi, {{user.username}}
                        {{else}}
                        <i class="bi bi-person me-1"></i>Hi, Guest
                        {{/if}}
                    </span>
                </a>
                <ul class="dropdown-menu dropdown-menu-end profile-dropdown-menu" aria-labelledby="navbarDropdownProfile">
                    {{#if user}}
                    <li><a class="dropdown-item d-flex align-items-center" href="/auth/reset-pwd">
                            <i class="bi bi-key me-2"></i>Reset Password
                        </a></li>
                    <li><a class="dropdown-item d-flex align-items-center" href="/auth/profile">
                            <i class="bi bi-person me-2"></i>Profile
                        </a></li>
                    <li>
                        <hr class="dropdown-divider m-0">
                    </li>
                    <li>
                        <div class="px-3 py-2">
                            <form method="POST" action="/auth/logout" class="w-100">
                                <button
                                    class="btn btn-outline-danger w-100 d-flex align-items-center justify-content-center"
                                    type="submit">
                                    <i class="bi bi-box-arrow-right me-2"></i>Logout
                                </button>
                            </form>
                        </div>
                    </li>
                    {{else}}
                    <li><a class="dropdown-item d-flex align-items-center" href="/auth/login">
                            <i class="bi bi-box-arrow-in-right me-2"></i>Login
                        </a></li>
                    <li><a class="dropdown-item d-flex align-items-center" href="/auth/register">
                            <i class="bi bi-person-plus me-2"></i>Register
                        </a></li>
                    {{/if}}
                </ul>
            </div>
        </div>
    </div>
</nav>